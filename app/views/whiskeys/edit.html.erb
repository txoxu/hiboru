<div class="container">
  <div class="row">
    <div class="col-md-6">
      <div class="edit-frame">
        <div class="whiskey-edit">
          <h1><%= t('.title') %></h1>
        </div>
        <%= form_with model: @whiskey, id: 'edit_whiskey', local: true do |f| %>
          <div class="mb-3">
            <%= f.label :name %><span class="text-danger">*</span>
            <%= f.text_field :name, class: "form-control", required: true %>
          </div>

          <div class="mb-3">
            <%= f.label :text %>
            <%= f.text_field :text, class: "form-control" %>
          </div>

          <div class="mb-3">
            <%= f.label :remmaining_quantity_id %><span class="text-danger">*</span>
            <%= f.collection_radio_buttons :remmaining_quantity_id, @quantities, :id, :quantity, class: "form-check-input", required: true do |rb| %>
              <%= rb.radio_button %>
              <%= rb.label(class: "form-check-label") %>
            <% end %>
          </div>
          
          <div class="mb-3">
            <%= f.label :image %>
            <%= f.file_field :image, class: "form-control" %>
          </div>

          <div class="mb-3">
            <%= f.label :category_names %><span class="text-danger">*</span>
            <%= f.select :category_names, @category_names.map { |c| c.category_name }, { prompt: "選択してください" }, class: "form-control", required: true %>
          </div>

          <div class="mb-3">
            <%= f.label :category_types %><span class="text-danger">*</span>
            <%= f.select :category_types, @category_types.map { |c| c.category_type }, { prompt: "選択してください" }, class: "form-control", required: true %>
          </div>

          <div class="actions">
            <%= f.submit t('helpers.submit.create'), class: "btn btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  
    <div class="col-md-3">
      <div class="image-container text-center">
        <div id="previews" class="border p-3">
          <%= t('helpers.preview') %>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="quantity-container text-center">
        <div id="quantity-previews" class="border p-3">
          <%= t('helpers.preview') %>
        </div>
      </div>
    </div>
  </div>
</div>


<script>
  document.addEventListener('turbo:load', function() {
    const radioButtons = document.querySelectorAll('input[name="whiskey[remmaining_quantity_id]"]');
    const preview = document.getElementById('quantity-previews');

const selectedQuantityId = document.querySelector('input[name="whiskey[remmaining_quantity_id]"]:checked');
  if (selectedQuantityId) {
    const initialQuantity = findQuantityById(selectedQuantityId.value);
    if (initialQuantity && initialQuantity.quantity_image) {
      const imagePath = '/assets/images/' + initialQuantity.quantity_image;
      preview.innerHTML = `<img src="${imagePath}" class="preview-image">`;
      preview.style.display = 'block';
    }
  }
    radioButtons.forEach(radio => {
      radio.addEventListener('change', function () {
        const selectedQuantityId = this.value;
        const selectedQuantity = findQuantityById(selectedQuantityId);
        
        if (selectedQuantity && selectedQuantity.quantity_image) {
          const imagePath = '/assets/images/' + selectedQuantity.quantity_image;
          preview.innerHTML = `<img src="${imagePath}" class="preview-image">`;
          preview.style.display = 'block';
        } else {
          preview.innerHTML = '';
          preview.style.display = 'none';
        }
      });
    });

    function findQuantityById(id) {
      const quantities = [
        { id: 1, quantity_image: '0ml.jpg' },
        { id: 2, quantity_image: '100ml.jpg' },
        { id: 3, quantity_image: '200ml.jpg' },
        { id: 4, quantity_image: '300ml.jpg' },
        { id: 5, quantity_image: '400ml.jpg' },
        { id: 6, quantity_image: '500ml.jpg' },
        { id: 7, quantity_image: '600ml.jpg' },
        { id: 8, quantity_image: '700ml.jpg' }
      ];

      return quantities.find(quantity => quantity.id.toString() === id);
    }
  });
</script>

